# CVE-2022-42889 (Text4Shell) Testing Script

This repository contains a Python script to automate the process of testing for a vulnerability known as Text4Shell, referenced under the CVE id: CVE-2022-42889.  

## About Text4Shell (CVE-2022-42889)  

Text4Shell is a critical vulnerability that affects a wide range of systems. The vulnerability lies in the way these systems parse text strings and allows for the execution of arbitrary code or SSRF attacks.  The vulnerability is exploited through crafted strings, where either JavaScript code is executed (leading to Remote Code Execution (RCE)) or URLs are fetched (leading to Server-Side Request Forgery (SSRF)).  

From [Tarlogic](https://www.tarlogic.com/blog/cve-2022-42889-text4shell-vulnerability/):

- **Exploitation requirements**:
- The application accepts user-controlled input that is subsequently processed by one of the following methods of the affected component:

	- StringLookupFactory.INSTANCE.interpolatorStringLookup().lookup()
	- StringSubstitutor.createInterpolator().replace()

- Java versions equal or greater than Java 15 would not be susceptible to remote code execution, since the Nashorn engine is disabled and the “script” prefix would not be available. However, other attacks via the “url” and “dns” prefixes would be possible.

## Script Usage  

This Python script helps in testing the presence of the Text4Shell vulnerability in a system. The scope of this script includes: testing of script and url prefixes.

The script has two modes of operation: RCE and SSRF, controlled by the `-m` or `--mode` command-line argument. It constructs a URL incorporating a crafted string based on the selected mode and makes a GET request to the URL.  

### RCE Mode  

In RCE mode, the script creates a crafted string that attempts to execute a JavaScript command. The command to be executed is passed as a command-line argument using `-c` or `--command`.  

```bash
python text4shell.py -u 'http://example.com/search?query=' -c 'your_command' -m 'rce'
```

### SSRF Mode

In SSRF mode, the script creates a crafted string that includes a URL fetch command.

```bash
python text4shell.py -u 'http://example.com/search?query=' -m 'ssrf' -s 'http://example.com/resource'
```

### Response

The script makes a GET request to the constructed URL and prints the HTTP response status code and body.
